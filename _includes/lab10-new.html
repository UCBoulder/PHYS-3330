<html>
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="generator" content="pandoc">
      <meta name="author" content="Department of Physics | University of
Colorado Boulder">
      
      <title>PHYS 3330</title>
         </head>
   <body>
            <div>
         <style>
            .eqnos { display: inline-block; position: relative; width: 100%; }
            .eqnos br { display: none; }
            .eqnos-number { position: absolute; right: 0em; top: 50%; line-height: 0; }
         </style>
         <h1 class="title">Lab 10 - Digital Electronics: ARDUINO</h1>
                  <h1 class="title">Contents</h1>
        <nav id="TOC">
            <ul>
            <li><a href="#goals" id="toc-goals"><span
            class="toc-section-number">1</span> Goals</a></li>
            <li><a href="#new-terms" id="toc-new-terms"><span
            class="toc-section-number">2</span> New Terms</a></li>
            <li><a href="#prelab" id="toc-prelab"><span
            class="toc-section-number">3</span> Prelab</a>
            <ul>
            <li><a href="#programmable-circuits---introduction"
            id="toc-programmable-circuits---introduction"><span
            class="toc-section-number">3.1</span> Programmable Circuits
            - Introduction</a>
            <ul>
            <li><a href="#1.1" id="toc-1.1"><span
            class="toc-section-number">3.1.1</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#mcus-vs-mpus-vs-sbcs-vs-fpgas"
            id="toc-mcus-vs-mpus-vs-sbcs-vs-fpgas"><span
            class="toc-section-number">3.2</span> MCUs vs MPUs vs SBCs
            vs FPGAs</a>
            <ul>
            <li><a href="#2.1" id="toc-2.1"><span
            class="toc-section-number">3.2.1</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#arduinos" id="toc-arduinos"><span
            class="toc-section-number">3.3</span> Arduinos</a>
            <ul>
            <li><a href="#3.1" id="toc-3.1"><span
            class="toc-section-number">3.3.1</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#arduino-circuits"
            id="toc-arduino-circuits"><span
            class="toc-section-number">3.4</span> Arduino Circuits</a>
            <ul>
            <li><a href="#3.2" id="toc-3.2"><span
            class="toc-section-number">3.4.1</span> Prelab
            Question</a></li>
            <li><a href="#3.3" id="toc-3.3"><span
            class="toc-section-number">3.4.2</span> Prelab
            Question</a></li>
            <li><a href="#3.4" id="toc-3.4"><span
            class="toc-section-number">3.4.3</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#analog-readings"
            id="toc-analog-readings"><span
            class="toc-section-number">3.5</span> Analog readings</a>
            <ul>
            <li><a href="#4.1" id="toc-4.1"><span
            class="toc-section-number">3.5.1</span> Prelab
            Question</a></li>
            <li><a href="#4.2" id="toc-4.2"><span
            class="toc-section-number">3.5.2</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#isolating-the-microcontroller"
            id="toc-isolating-the-microcontroller"><span
            class="toc-section-number">3.6</span> Isolating the
            Microcontroller</a>
            <ul>
            <li><a href="#5.1" id="toc-5.1"><span
            class="toc-section-number">3.6.1</span> Prelab
            Question</a></li>
            <li><a href="#5.2" id="toc-5.2"><span
            class="toc-section-number">3.6.2</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#controlling-a-relay"
            id="toc-controlling-a-relay"><span
            class="toc-section-number">3.7</span> Controlling a
            Relay</a>
            <ul>
            <li><a href="#6.1" id="toc-6.1"><span
            class="toc-section-number">3.7.1</span> Prelab
            Question</a></li>
            <li><a href="#6.2" id="toc-6.2"><span
            class="toc-section-number">3.7.2</span> Prelab
            Question</a></li>
            <li><a href="#6.3" id="toc-6.3"><span
            class="toc-section-number">3.7.3</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#opto-isoated-relay-switch"
            id="toc-opto-isoated-relay-switch"><span
            class="toc-section-number">3.8</span> Opto-isoated Relay
            Switch</a>
            <ul>
            <li><a href="#7.1" id="toc-7.1"><span
            class="toc-section-number">3.8.1</span> Prelab
            Question</a></li>
            <li><a href="#7.2" id="toc-7.2"><span
            class="toc-section-number">3.8.2</span> Prelab
            Question</a></li>
            <li><a href="#7.3" id="toc-7.3"><span
            class="toc-section-number">3.8.3</span> Prelab
            Question</a></li>
            </ul></li>
            <li><a href="#lab-activities" id="toc-lab-activities"><span
            class="toc-section-number">3.9</span> Lab Activities</a>
            <ul>
            <li><a href="#8.1" id="toc-8.1"><span
            class="toc-section-number">3.9.1</span> Prelab
            Question</a></li>
            <li><a href="#8.2" id="toc-8.2"><span
            class="toc-section-number">3.9.2</span> Prelab
            Question</a></li>
            </ul></li>
            </ul></li>
            <li><a href="#useful-readings"
            id="toc-useful-readings"><span
            class="toc-section-number">4</span> Useful Readings</a></li>
            <li><a href="#lab-activities-1"
            id="toc-lab-activities-1"><span
            class="toc-section-number">5</span> Lab Activities</a>
            <ul>
            <li><a href="#blink" id="toc-blink"><span
            class="toc-section-number">5.1</span> Blink</a></li>
            <li><a href="#potentiometer-as-a-control-dial"
            id="toc-potentiometer-as-a-control-dial"><span
            class="toc-section-number">5.2</span> Potentiometer as a
            Control Dial</a></li>
            <li><a href="#led-bank" id="toc-led-bank"><span
            class="toc-section-number">5.3</span> 10-LED bank</a></li>
            <li><a href="#opto-isolated-relay-control"
            id="toc-opto-isolated-relay-control"><span
            class="toc-section-number">5.4</span> Opto-isolated Relay
            Control</a></li>
            <li><a href="#explore---choose-your-own-project"
            id="toc-explore---choose-your-own-project"><span
            class="toc-section-number">5.5</span> Explore - Choose Your
            Own Project</a></li>
            </ul></li>
            <li><a href="#appendix-a-few-project-ideas"
            id="toc-appendix-a-few-project-ideas"><span
            class="toc-section-number">6</span> Appendix: A Few Project
            Ideas</a></li>
            </ul>
        </nav>
        <hr/>
         <h1 data-number="1" id="goals"><span
         class="header-section-number">1</span> Goals</h1>
         <p>In this lab, we will get a sense of the capabilities of
         Arduino microcontroller boards. Microcontroller units (aka
         microcontrollers, MCUs, or μCs) are <em>computers on a
         chip</em>; they are programmable ICs (integrated circuit) that
         contain</p>
         <ul>
         <li>a central processing unit (CPU)</li>
         <li>volatile memory (RAM)</li>
         <li>non-volatile memory (ROM, EPROM, EEPROM, or flash) to store
         programs</li>
         <li>digital inputs and outputs</li>
         <li>analog inputs and outputs</li>
         <li>serial inputs and outputs (for communication)</li>
         <li>clocks or timers</li>
         </ul>
         <p>They are simple computing machines on a single chip designed
         for control in embedded systems. You can find MCUs in</p>
         <ul>
         <li>toys</li>
         <li>refrigerators</li>
         <li>cars</li>
         <li>televisions</li>
         <li>cameras</li>
         <li>microwaves</li>
         <li>washing machines</li>
         <li><strong>laboratory equipment</strong></li>
         <li>you name it!</li>
         </ul>
         <p>Even though microcontrollers are <em>technically</em>
         computers, they are used in far more specialized applications
         than the <em>general purpose computers</em> you’re used to
         thinking about (like your laptop, tablet, smartphone or desktop
         computer). They are not used for running operating systems
         (like Linux, Windows, macOS, iOS, or Android) and are
         programmed to run specific tasks, like managing the operations
         of a refrigerator (e.g. monitoring the temperature and running
         the refrigeration cycle when needed).</p>
         <p>In this lab you will learn to</p>
         <ul>
         <li>write C++ programs (sketches) in the Arduino IDE</li>
         <li>control LEDs with the Arduino</li>
         <li>control a relay safely without risk of damaging the
         Arduino</li>
         </ul>
         <h1 data-number="2" id="new-terms"><span
         class="header-section-number">2</span> New Terms</h1>
         <p><strong>General Purpose Input/Output (GPIO)</strong> - these
         are digital signal pins on microcontrollers that can be
         programmed to either measure or set digital signals. If they
         are programmed as an input, they can read either 0 or 1, and if
         they are programmed as an output, they can either set 0 or
         1.</p>
         <p><strong>IDE</strong> - “Integrated Development Environment.”
         Software specifically designed for writing programs in a
         certain setting or context. The Arduino IDE is specifically
         designed to greatly simplify the process of programming
         compatible microcontrollers.</p>
         <p><strong>Sketch</strong> - the program files you write in the
         Arduino IDE. Sketches are written in the C++ programming
         language, but it is also possible to use <a
         href="https://realpython.com/arduino-python/">Python</a> and
         other languages (we will use the C++ default in this lab).</p>
         <p><strong>Relay</strong> - a current controlled switch. Relays
         differ from transistors in that they are electro-mechanical
         objects: they are true, physical switches controlled by an
         electromagnet. Running current through the electromagnet pulls
         or pushes the switch into either an open or closed position
         (there are many constructions for different applications).</p>
         <p><strong>Optocoupler (aka optoisolator)</strong> - this
         device is similar to the optical-link you built in lab 6. It
         has two isolated parts: (1) an internal LED, and (2) a sensor
         which modulates current as a function of measured light. This
         allows you to send a signal from one circuit to another without
         any electrical contact between the two.</p>
         <h1 data-number="3" id="prelab"><span
         class="header-section-number">3</span> Prelab</h1>
         <h2 data-number="3.1"
         id="programmable-circuits---introduction"><span
         class="header-section-number">3.1</span> Programmable Circuits
         - Introduction</h2>
         <p>Suppose you want to build something more complex than the
         digital circuits we studied in lab 9. For example, you might
         have a photodiode that you want to hook up to a computer so you
         can automatically adjust your experiment in response to
         changing light intensity, maybe by adjusting the current
         powering a laser. Or, say you want to build a tiny,
         battery-powered data transmitter to feed to a dolphin and find
         out how her body temperature varies while she’s swimming around
         in the ocean. Since it’s hard to transmit signals through a
         dolphin, the transmitter should store the temperature data
         until it is excreted by the dolphin and floats to the surface
         where your receiver can detect the signal.</p>
         <p>These and many other applications require complex digital
         circuitry. Any digital system, including a programmable
         computer, can be built by combining the gates you worked with
         in lab 9 that utilize (BJT-based) <a
         href="https://en.wikipedia.org/wiki/Transistor%E2%80%93transistor_logic">transistor-transistor
         logic</a> (TTL). In fact, the first personal computer to reach
         the market (1971) had a CPU built out of many TTL chips.
         However, TTL isn’t practical for scaling. Modern computer
         design ulilizes <a
         href="https://en.wikipedia.org/wiki/Very_Large_Scale_Integration">very
         large scale integration</a> (VLSI), which is the process of
         integrating millions to trillions of MOSFETs into compact ICs
         which are fabricated using a process called <a
         href="https://en.wikipedia.org/wiki/CMOS">CMOS</a>. MOSFETs
         have lots of advantages over BJTs in this particular
         application: <a
         href="https://electronics.stackexchange.com/a/527268">here’s a
         nice post on stackexchange discussing the pros and cons of
         MOSFETs</a>, but most importantly, they’re easier to shrink
         down and fabricate en masse than BJTs.</p>
         <p>There are plenty of applications where TTL chips are the
         best solution, but if you find yourself needing more than a
         small handful of these chips, it is probably time to consider
         using a different tool.</p>
         <h3 data-number="3.1.1" id="1.1"><span
         class="header-section-number">3.1.1</span> Prelab Question</h3>
         <p>Give 3 reasons why MOSFETs would be used for <strong>very
         large scale integration</strong> programmable circuits instead
         of BJTs</p>
         <h2 data-number="3.2" id="mcus-vs-mpus-vs-sbcs-vs-fpgas"><span
         class="header-section-number">3.2</span> MCUs vs MPUs vs SBCs
         vs FPGAs</h2>
         <p>Here is the full section leading up to that question. The
         title of the section is “MCUs vs MPUs vs FPGAs”</p>
         <p><strong>Microcontroller unit (MCU)</strong> – a small
         computer on a single IC that includes a processor, volatile and
         non-volatile memory, and input/outputs. These are used for
         specialized tasks in control systems. MCUs can be found on
         pre-built boards that facilitate interacting with the MCU (the
         Arduino that you will use for this lab is just one example of
         this kind of microcontroller board). Microcontrollers are
         technically computers, but they are not general computers like
         a laptop or a smartphone; they lack operating systems and are
         programmed for specific tasks.</p>
         <p><strong>Microcontroller development board</strong> - an
         Arduino is a development board designed to greatly simplify the
         process of interfacing with and programming the
         microcontroller.</p>
         <p><strong>Microprocessor unit (MPU)</strong> - a chip that
         processes tasks. Both CPUs and GPUs (graphics processing units)
         are examples of MPUs. Often, people refer to <em>single board
         computers</em> as microprocessors because of the symmetry of
         “MCU vs MPU,” but the microprocessor involved is just the CPU
         chip on a single board computer. A microcontroller chip
         contains all the functions of a microprocessor but with
         supporting elements like memory.</p>
         <p><strong>Single board computer (SBC)</strong> - a general
         computer on a single board that is small enough to embed in a
         system. Often these have inputs and outputs like a
         microcontroller board. The most popular SBC is the Raspberry
         Pi, but there are also many alternatives. SBCs are more costly
         and consume more power than microcontrollers. SBCs can run full
         operating systems and can technically do anything your laptop
         can, like edit spreadsheets, browse the web, play games, and
         edit, compile, and/or run code. Because they typically have
         built in ethernet and/or Wi-Fi, they are often used as servers
         which can accept commands from other devices, perform tasks,
         then return information (this is how hosting a website works).
         In physics labs, these SBC servers can be used to interface
         with lab equipment to automate experiments and allow you to
         communicate with them over a local network. SBCs also typically
         have HDMI output and USB ports allowing you to connect a
         monitor, keyboard, and mouse so that you can write programs
         directly on them (microcontrollers require you to write
         programs on another computer and then send the programs over a
         serial connection).</p>
         <p><strong>Field Programmable Gate Array (FPGA)</strong> – A
         single IC containing an array of logic gates. FPGAs are
         “hardware LEGOs®” that have configurable logic blocks (the
         LEGO® pieces) that can be programmed to act as different logic
         gates. FPGAs are extremely versatile since they can be
         programmed to do anything on the logic gate level, and can even
         be programmed to be the same hardware as an MCU or MPU (just
         buy an MCU or MPU at that point). FPGAs can be used to replace
         a large pile of TTL chips. FPGAs can also be programmed to
         process information in a highly parallel fashion making them
         far faster than microcontrollers (if you know what you’re
         doing). However, FPGAs are much more costly than any of the
         above options and are usually only used in applications where
         rapid prototyping or on the fly development of digital circuits
         is needed. The largest FPGAs can contain 300,000 gates or more,
         and the programming effort can become a major project in and of
         itself.</p>
         <p>For more on FPGAs:</p>
         <ul>
         <li><p>Horowitz and Hill 2<sup>nd</sup> ed - Sections 8.15,
         8.27</p></li>
         <li><p>Horowitz and Hill 3<sup>rd</sup> ed - Sections
         11–11.2.5</p></li>
         </ul>
         <h3 data-number="3.2.1" id="2.1"><span
         class="header-section-number">3.2.1</span> Prelab Question</h3>
         <p>Match the following three tools to the applications you
         think they would be best suited for</p>
         <ol type="a">
         <li><p>Microcontroller board (like an Arduino)</p></li>
         <li><p>Single board computer (like a Raspberry Pi)</p></li>
         <li><p>FPGA</p></li>
         </ol>
         <ol type="1">
         <li><p>You need to control an array of LEDs based on RPM
         measurement of a motor.</p></li>
         <li><p>You need control a satellite that requires highly
         parallelized computations, and you will likely need to update
         the system regularly.</p></li>
         <li><p>You need to control measurement equipment, record data,
         and access the stored data over a network.</p></li>
         <li><p>You need to rapidly prototype a complex digital
         circuit.</p></li>
         <li><p>You need to automate an experiment and plot the data on
         a screen <em>live</em> as it is being taken.</p></li>
         <li><p>You need to build a temperature controller that reads
         temperatures and sets an appropriate amount of power to a
         heater to reach a setpoint.</p></li>
         </ol>
         <h2 data-number="3.3" id="arduinos"><span
         class="header-section-number">3.3</span> Arduinos</h2>
         <div id="fig:arduino" class="fignos">
         <figure>
         <img src="../resources/lab10fig/arduino.png"
         alt="Figure 1: The actual MCU is an IC (ATMEL ATmega328P) on the Arduino board. It comes in two styles: a DIP (dual in-line package) style and SMD (surface mount device). The DIP chip MCU can be pulled out and used in other circuits." />
         <figcaption aria-hidden="true"><span>Figure 1:</span> The
         actual MCU is an IC (ATMEL ATmega328P) on the Arduino board. It
         comes in two styles: a DIP (dual in-line package) style and SMD
         (surface mount device). The DIP chip MCU can be pulled out and
         used in other circuits.</figcaption>
         </figure>
         </div>
         <p>In this lab, we will take a look at what microcontrollers
         can do by working with the Arduino Uno board.</p>
         <blockquote>
         <p>Arduino is an open-source electronics platform based on
         easy-to-use hardware and software. Arduino boards are able to
         read inputs - light on a sensor, a finger on a button, or a
         Twitter message - and turn it into an output - activating a
         motor, turning on an LED, publishing something online. You can
         tell your board what to do by sending a set of instructions to
         the microcontroller on the board. To do so you use the Arduino
         programming language (based on Wiring), and the Arduino
         Software (IDE), based on Processing. (<a
         href="https://www.arduino.cc/en/Guide/Introduction">Arduino
         website</a>)</p>
         </blockquote>
         <p>Arduino has been highly successful in developing simple,
         open-source, microcontroller boards that can be programmed
         easily. These boards have a huge international following that
         has resulted in a wide range of books, publicly available
         programs, robotics kits, and the like. These resources make the
         Arduino a common and easy choice when thinking about a
         microcontroller project because there is a large and active
         online community around Arduino development.</p>
         <p>The heart of the Arduino Uno is the 28 pin ATMEL <a
         href="https://en.wikipedia.org/wiki/ATmega328">ATmega328P</a>
         MCU chip (see Figure <a href="#fig:arduino">1</a>). It is a
         member of the ATMEL 8-bit <a
         href="https://en.wikipedia.org/wiki/AVR_microcontrollers">AVR
         microcontroller family</a>, with</p>
         <ul>
         <li><p>32 kB of 8-bit wide flash memory to store the program
         you write,</p></li>
         <li><p>1 kB of electronically erasable and programmable EEPROM
         that is normally used to save data between power
         cycles,</p></li>
         <li><p>2 kB of 8 bit data SRAM for excecuting programs (this is
         where ints, floats, chars, etc will be stored while code is
         running),</p></li>
         </ul>
         <p>The program you send to the ATmega328P gets stored in flash
         memory (based on NAND gates), so you can program it over and
         over again as you debug your hardware and code; flash is
         non-volatile, so the chip won’t forget its programming when you
         turn the power off. The Arduino board is designed to allow you
         to interface with the MCU through a USB port. The Arduino IDE
         allows you to easily interact with the board via serial
         connection and the software allows you to upload your code to
         the Arduino and allows you to see messages sent back to the
         computer over the serial connection. When plugged into your
         computer with the USB cable, the Arduino board will also take
         power through the cable.</p>
         <p>Nearly every pin of the ATmega328P MCU can be programmed in
         multiple ways for various uses. It has</p>
         <ul>
         <li><p>up to 23 GPIO pins: they can be used to read <em>or</em>
         set digital voltages.</p></li>
         <li><p>an internal, variable frequency clock and three separate
         timer/counter/scalers.</p></li>
         <li><p>a comparator with a programmable voltage
         reference</p></li>
         <li><p>6 channels of pulse-width-modulated (PWM) output to
         simulate adjustable external analog voltages</p></li>
         <li><p>a 10-bit analog-to-digital converter with a 6-channel
         analog multiplexer, so you can digitize 6 separate analog
         signals.</p></li>
         </ul>
         <p>Amazingly, you can have all this for ~$3 per MCU (although
         the full Arduino Uno R3 board runs for ~$25).</p>
         <p>The Arduino Uno R3 is a printed circuit board (PCB) with not
         only the ATmega328P MCU, but several other components on it to
         make it easy to interact with. <a
         href="https://www.arduino.cc/en/uploads/Main/Arduino_Uno_Rev3-schematic.pdf">The
         full circuit diagram of the PCB can be found here.</a> You will
         see another microcontroller chip (Atmega16U2) that is used by
         the board to interface with the USB port. This is largely what
         makes the Arduino so useful and easy to work with.</p>
         <p>Arduino sketches are written in C++ and always take on the
         following form:</p>
         <div class="sourceCode" id="cb1"><pre
         class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// You can define global variables at the top of the sketch</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">// The Arduino will start by calling this function.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> loop<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   <span class="co">// After setup() is done, the Arduino will execute this</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>   <span class="co">// function repeatedly until it is reset or powered off.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
         <p>Here is a Pythonic repesentation of what is happening under
         the hood:</p>
         <div class="sourceCode" id="cb2"><pre
         class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arduino_stuff</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>setup()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>   loop()</span></code></pre></div>
         <h3 data-number="3.3.1" id="3.1"><span
         class="header-section-number">3.3.1</span> Prelab Question</h3>
         <p>Set up the Arduino software</p>
         <ol type="1">
         <li><p><a
         href="https://www.arduino.cc/en/software#future-version-of-the-arduino-ide">Download
         the Arduino IDE</a> on your device of choice (runs on Windows,
         macOS, and Linux).</p>
         <ul>
         <li><p>We have USB-A to USB-C adapters in the lab that you can
         use if your device doesn’t have any USB-A ports.</p></li>
         <li><p>Both you and your lab partner should have the IDE ready,
         just in case either of you run into issues with your
         device.</p></li>
         </ul></li>
         <li><p>Install the software on your computer. You will need the
         Desktop IDE for this lab (not the Web IDE).</p></li>
         <li><p>Download <a
         href="../resources/lab10fig/ardunio_starter_sketch.ino">this</a>
         starter sketch file.</p></li>
         <li><p>Open it in the Arduino IDE.</p></li>
         <li><p>Read through it.</p></li>
         <li><p>See the <a
         href="https://www.arduino.cc/reference/en/">“Language
         Reference” section of the Arduino website</a>.</p></li>
         </ol>
         <p>Describe: 1. the <code>pinMode()</code> command</p>
         <ol start="2" type="1">
         <li><p>the <code>digitalWrite()</code> command</p></li>
         <li><p>what the script will do.</p></li>
         </ol>
         <h2 data-number="3.4" id="arduino-circuits"><span
         class="header-section-number">3.4</span> Arduino Circuits</h2>
         <p>In this lab, you <strong>will not</strong> connect the
         Arduino to Earth ground. You have connected all of your
         circuits to Earth ground up to this point. You will power your
         Arduino via the USB cable from your computer.</p>
         <div id="fig:grounds" class="fignos">
         <figure>
         <img src="../resources/lab10fig/grounds.png"
         alt="Figure 2: Common ground is a point at which you are arbitrarily calling 0\text{ V}. Earth ground is a connection to the Earth." />
         <figcaption aria-hidden="true"><span>Figure 2:</span> Common
         ground is a point at which you are arbitrarily calling <span
         class="math inline">\(0\text{ V}\)</span>. Earth ground is a
         connection to the Earth.</figcaption>
         </figure>
         </div>
         <p>In this lab, all the circuit diagrams show a common ground
         symbol (see Figure <a href="#fig:grounds">2</a>) for
         connections to the <strong>GND</strong> pin of the Arduino
         board. Connections to the ground of the power supply,
         oscilliscope, and/or function generator are connections to
         Earth ground, and will be labeled with the Earth ground symbol
         in circuit diagrams.</p>
         <p>When you draw your diagrams, make sure to use the right
         ground symbol when appropriate. We will take care to separate
         and isolate the Arduino circuit from the power supply, and the
         distinction between these two grounds is important.</p>
         <h3 data-number="3.4.1" id="3.2"><span
         class="header-section-number">3.4.1</span> Prelab Question</h3>
         <p>The GPIO on the Arduino board can programmatically set <span
         class="math inline">\(5\text{ V}\)</span>. The ATmega328P
         datasheet says that each GPIO can source a maximum of <span
         class="math inline">\(40\text{ mA}\)</span> of current.</p>
         <p>What’s the <strong><em>minimum</em></strong> load that
         should be applied to a GPIO pin?</p>
         <h3 data-number="3.4.2" id="3.3"><span
         class="header-section-number">3.4.2</span> Prelab Question</h3>
         <p>The <a
         href="https://ucboulder.github.io/PHYS-3330/resources/manuals-and-data-sheets/ds-HLMP-C625-LED.pdf">HLMP-C625</a>
         LED has a recommended operating current of <span
         class="math inline">\(20\text{ mA}\)</span> and has a
         typicalforward voltage of <span class="math inline">\(1.9\text{
         V}\)</span>.</p>
         <p>What resistance should you put in series with this LED to
         get the recommended current when powered by the
         microcontrollers GPIO pin?</p>
         <h3 data-number="3.4.3" id="3.4"><span
         class="header-section-number">3.4.3</span> Prelab Question</h3>
         <p>In many microcontroller applications, LEDs are used as
         indicators to alert users what might be happening in the
         system. When multiple LEDs are being used, there are two ways
         to limit the current through them as seen in Figure <a
         href="#fig:led-limiting">3</a>. In the lab you will be using
         the MV57164 LED bank of 10 LEDs. This LED bank has a similar
         design to a DIP chip with 10 LEDs running down chip with all
         the anodes on one side and cathodes on the other side. The
         forward voltage of these LEDs is about <span
         class="math inline">\(2\text{ V}\)</span>.</p>
         <div id="fig:led-limiting" class="fignos">
         <figure>
         <img src="../resources/lab10fig/leds.png"
         alt="Figure 3: LEDs linked in parallel (these could be connected to different GPIO pins) can either have a) individual current limiting resistors or b) a single current limiting restance." />
         <figcaption aria-hidden="true"><span>Figure 3:</span> LEDs
         linked in parallel (these could be connected to different GPIO
         pins) can either have a) individual current limiting resistors
         or b) a single current limiting restance.</figcaption>
         </figure>
         </div>
         <p>Assuming you have <span class="math inline">\(N\)</span>
         LEDs with current limiting resistors <span
         class="math inline">\(R\)</span>, for both circuits a) and
         b):</p>
         <ol type="1">
         <li><p>What is the voltage <span
         class="math inline">\(V_R\)</span> across the resitor(s)
         (express in volts)?</p></li>
         <li><p>What is the current <span
         class="math inline">\(I_R\)</span> through the resistor(s)
         (express in terms of <span class="math inline">\(N\)</span>,
         <span class="math inline">\(V_R\)</span>, <span
         class="math inline">\(R\)</span>)?</p></li>
         <li><p>What is the current <span
         class="math inline">\(I_\text{LED}\)</span> through the LEDs
         (express in terms of <span class="math inline">\(N\)</span>,
         <span class="math inline">\(V_R\)</span>, <span
         class="math inline">\(R\)</span>)? Is your answer consistent
         with Kircchoff’s current law?</p></li>
         <li><p>Write an expression for <span
         class="math inline">\(R\)</span> with respect to <span
         class="math inline">\(N\)</span>, <span
         class="math inline">\(V_R\)</span>, and the desired LED current
         <span class="math inline">\(I_\text{LED}\)</span>.</p></li>
         <li><p>Given your results, if <span
         class="math inline">\(N\)</span> is something that will change
         (i.e. different amounts of LEDs will be turned on and off at
         different times), which arrangement (a or b) will properly
         limit the current?</p></li>
         </ol>
         <h2 data-number="3.5" id="analog-readings"><span
         class="header-section-number">3.5</span> Analog readings</h2>
         <p>The Arduino Uno has 6 analog input pins, which convert an
         analog input (between <span class="math inline">\(0\)</span>
         and <span class="math inline">\(5\text{ V}\)</span> by default)
         into a digital value with 10 bits of resolution. This means
         that it will store the value as a binary number between 00 0000
         0000 (representing <span class="math inline">\(0\text{
         V}\)</span>) and 11 1111 1111 (representing <span
         class="math inline">\(5\text{ V}\)</span>). When this number is
         sent to a computer to read out, it will be printed as a decimal
         number (i.e. 1111 <span class="math inline">\(\rightarrow
         15\)</span>)</p>
         <h3 data-number="3.5.1" id="4.1"><span
         class="header-section-number">3.5.1</span> Prelab Question</h3>
         <ol type="1">
         <li><p>What is the decimal equivalent of the binary number that
         represents <span class="math inline">\(5\text{
         V}\)</span>?</p></li>
         <li><p>Write a function (in Python or Mathematica) that
         converts a decimal equivalent of the binary stored value to
         volts</p>
         <ul>
         <li>input is a number between <span
         class="math inline">\(0\)</span> and the number calculated
         above</li>
         <li>output is a number in volts</li>
         <li>test that plugging in <span
         class="math inline">\(0\)</span> returns <span
         class="math inline">\(0\text{ V}\)</span> and plugging in the
         number you calculated above returns <span
         class="math inline">\(5\text{ V}\)</span></li>
         </ul></li>
         </ol>
         <h3 data-number="3.5.2" id="4.2"><span
         class="header-section-number">3.5.2</span> Prelab Question</h3>
         <p>In the lab, you will use a potentiometer as a variable
         voltage divider with a <span class="math inline">\(5\text{
         V}\)</span> input and use an analog input to read the <span
         class="math inline">\(V_\text{out}\)</span> of the voltage
         divider. This is a common way for a user to interact with a
         microcontroller via a dial.</p>
         <ol type="1">
         <li>Draw a schematic of the circuit diagram for the
         potentiometer acting as a control for the Arduino.</li>
         </ol>
         <p><em>Hint:</em> The <span class="math inline">\(5\text{
         V}\)</span> should come from the Arduino itself.</p>
         <ol start="2" type="1">
         <li>The potentiometers on your breadboard header are <span
         class="math inline">\(10\text{ k}\Omega\)</span>; how much
         power is drawn by having this potemetiometer being used as a
         control dial?</li>
         </ol>
         <h2 data-number="3.6" id="isolating-the-microcontroller"><span
         class="header-section-number">3.6</span> Isolating the
         Microcontroller</h2>
         <p>Microcontrollers are often used to control elements of
         analog circuits that involve higher power which could
         potentially damage the MCU. Inductive elements like relays and
         motors can be particularly hazardous because they are capable
         of creating electrical surges and back EMF.</p>
         <p><a
         href="https://www.powerelectronictips.com/why-use-optocouplers-in-electronics/">Optocouplers</a>
         (aka optoisolators) are used to isolate microcontrollers from
         circuits they control. These are simple ICs, very similar to
         the optical-link you built in lab 6, that contains an LED and a
         phototransistor (see Figure <a
         href="#fig:optocoupler">4</a>).</p>
         <div id="fig:optocoupler" class="fignos">
         <figure>
         <img src="../resources/lab10fig/optocoupler.png"
         alt="Figure 4: An optocoupler has an internal infrared LED. When the LED is on, it activates a phototransistor and allows current to flow from the collector to the emitter." />
         <figcaption aria-hidden="true"><span>Figure 4:</span> An
         optocoupler has an internal infrared LED. When the LED is on,
         it activates a phototransistor and allows current to flow from
         the collector to the emitter.</figcaption>
         </figure>
         </div>
         <p><span style="color: red;"><strong>TO ISOLATE THE CIRCUIT
         FROM THE ARDUINO, THE ARDUINO COMMON GROUND MUST <em>NOT</em>
         BE CONNECTED TO THE CIRCUIT’S GROUND</strong></span></p>
         <h3 data-number="3.6.1" id="5.1"><span
         class="header-section-number">3.6.1</span> Prelab Question</h3>
         <p>Open the datasheet for the optocoupler (SFH615AGR).</p>
         <ol type="1">
         <li><p>What is the maximum forward current that can put through
         the LED? (any more current than this and you will blow the
         LED)</p></li>
         <li><p>What is the typical forward voltage of the LED (i.e. the
         voltage drop when forward biased)?</p></li>
         <li><p>What is the maximum output collector current (steady on,
         not pulsed)?</p></li>
         </ol>
         <h3 data-number="3.6.2" id="5.2"><span
         class="header-section-number">3.6.2</span> Prelab Question</h3>
         <p>We recommend targetting roughly <span
         class="math inline">\(17\text{ mA}\)</span> to activate the
         optocoupler. What current limiting resistance <span
         class="math inline">\(R_{cl}\)</span> should you use.</p>
         <p><em>Hint:</em> the Arduino ouptuts <span
         class="math inline">\(5\text{ V}\)</span> and don’t forget the
         forward voltage drop across the LED.</p>
         <h2 data-number="3.7" id="controlling-a-relay"><span
         class="header-section-number">3.7</span> Controlling a
         Relay</h2>
         <p>Relays are a common thing to control with a microcontroller.
         They are electromechanical switches that use an electromagnetic
         coil to throw an internal switch to either break or make
         contact (depending on the application).</p>
         <figure>
         <img src="../resources/lab10fig/relay.png"
         alt="Example of a relay that would be found in a car. A spring holds the switch against the normally closed contact, and running current through the coil will pull the switch down to the normally open contact." />
         <figcaption aria-hidden="true">Example of a relay that would be
         found in a car. A spring holds the switch against the
         <em>normally closed contact</em>, and running current through
         the coil will pull the switch down to the <em>normally open
         contact</em>.</figcaption>
         </figure>
         <p>The coil can be modeled as a resistor and inductor in series
         (see Figure <a href="#fig:relay-circuit">5</a>). A diode must
         be placed in parallel with the coil to allow stored energy to
         discharge safely when the coil is switched off. Diodes used in
         this way are referred to as “flyback diodes,” and without them,
         the inductor can cause unwanted voltage spikes in your
         cicuit.</p>
         <div id="fig:relay-circuit" class="fignos">
         <figure>
         <img src="../resources/lab10fig/relay-circuit.png"
         alt="Figure 5: The coil of the relay can be modeled with an inductor and resistor in series. It is necessary to place a diode in parallel with the coil to protect the rest of the circuit." />
         <figcaption aria-hidden="true"><span>Figure 5:</span> The coil
         of the relay can be modeled with an inductor and resistor in
         series. It is necessary to place a diode in parallel with the
         coil to protect the rest of the circuit.</figcaption>
         </figure>
         </div>
         <h3 data-number="3.7.1" id="6.1"><span
         class="header-section-number">3.7.1</span> Prelab Question</h3>
         <p>Apart from the moments when the relay is switched, the
         system is in a state of equilibrium, i.e. the current is
         constant.</p>
         <p>In this case, can the model of the coil be reasonably
         simplified?</p>
         <h3 data-number="3.7.2" id="6.2"><span
         class="header-section-number">3.7.2</span> Prelab Question</h3>
         <p>Open the datasheet for the relay (J104D2C12VDC.20S). This
         datasheet covers a few different relays of similar design. The
         one you will use is the 12VDC 0.2W variation.</p>
         <p>What is the coil resistance?</p>
         <h3 data-number="3.7.3" id="6.3"><span
         class="header-section-number">3.7.3</span> Prelab Question</h3>
         <p>Since it is likely that a circuit you build will involve an
         op-amp, and your experience is with the LF356, it is reasonable
         to assume you will be powering your circuit with <span
         class="math inline">\(\pm 15\text{ V}\)</span>; however, the
         relay is rated for <span class="math inline">\(12\text{
         V}\)</span>. This means you need to put a resistor in series
         with the coil so that only <span class="math inline">\(12\text{
         V}\)</span></p>
         <ol type="1">
         <li><p>Draw a diagram</p></li>
         <li><p>Calculate the necessary resistance to get <span
         class="math inline">\(12\text{ V}\)</span> across the coil when
         <span class="math inline">\(15\text{ V}\)</span> is applied to
         both resistances combined.</p></li>
         <li><p>What is the current through the coil in the on
         state?</p></li>
         </ol>
         <h2 data-number="3.8" id="opto-isoated-relay-switch"><span
         class="header-section-number">3.8</span> Opto-isoated Relay
         Switch</h2>
         <div id="fig:opto-isolated-relay" class="fignos">
         <figure>
         <img src="../resources/lab10fig/relay-control-circuit2.png"
         alt="Figure 6: Relay control with an optocoupler isolating the Arduino and an NPN transistor used as a switch." />
         <figcaption aria-hidden="true"><span>Figure 6:</span> Relay
         control with an optocoupler isolating the Arduino and an NPN
         transistor used as a switch.</figcaption>
         </figure>
         </div>
         <p>The circuit shown in Figure <a
         href="#fig:opto-isolated-relay">6</a> shows a fully
         opto-isolated relay switch that can safely be operated without
         risk of damaging the Arduino. You already calculated <span
         class="math inline">\(R_{cl}\)</span> to limit the current
         through the optocoupler’s LED and <span
         class="math inline">\(R_1\)</span> to get the correct voltage
         across the relay’s coil. Now it is important to understand the
         role of the base resistor <span
         class="math inline">\(R_b\)</span> and find a reasonable value
         for it.</p>
         <p>In lab 8, you used NPN transistors (BJTs) in to build an
         audio amplifier with voltage gain. This is a far simpler
         <em>BJT switch</em> application. In this configuration, the BJT
         acts as a switch:</p>
         <ul>
         <li><p>When no current flows through the base, no current flows
         through the collector (the relay coil is off)</p></li>
         <li><p>When current flows through the base <span
         class="math inline">\(I_b\)</span>, the current gain <span
         class="math inline">\(h_{FE}\)</span> means that up to <span
         class="math inline">\(I_c=h_{FE}I_b\)</span> will flow through
         the collector (activating the relay)</p></li>
         </ul>
         <p>However, the base current <span
         class="math inline">\(I_b\)</span> should be targeted such that
         the collector current <span class="math inline">\(I_c\)</span>
         is limited by the <span class="math inline">\(15\text{
         V}\)</span> applied from the top of the relay coil to the
         emitter of the NPN. You already calculated this current above.
         Depending on the exact value of <span
         class="math inline">\(h_{FE}\)</span> is never recommended as
         this value depends on a number of factors.</p>
         <h3 data-number="3.8.1" id="7.1"><span
         class="header-section-number">3.8.1</span> Prelab Question</h3>
         <p>Looking at the datasheet for the 2N3904, the smallest value
         for the current gain shown is <span
         class="math inline">\(h_{FE}=40\)</span>. For switching
         applications like this, it is best to target a base current
         such that the current gain will easily hit the full collector
         current. Using the calculated relay current above (this will be
         the collector current in this application), calcuate the base
         current needed such that only a current gain of 10 is needed;
         i.e.</p>
         <p><span class="math display">\[I_c = 10I_b\]</span></p>
         <p>This will guarantee that enough current flows through the
         base to get the full amount of collector current needed.</p>
         <h3 data-number="3.8.2" id="7.2"><span
         class="header-section-number">3.8.2</span> Prelab Question</h3>
         <p>In this circuit, when the optocoupler is activated by the
         Arduino, the voltage at the phototransistor’s emitter will be
         <span class="math inline">\(15\text{ V}\)</span>.</p>
         <p>Calculate the base resistance <span
         class="math inline">\(R_b\)</span> needed to get the <span
         class="math inline">\(I_b\)</span> you calculated.</p>
         <p><em>Note:</em> don’t forget to account for the diode-like
         voltage drop from base to emitter.</p>
         <h3 data-number="3.8.3" id="7.3"><span
         class="header-section-number">3.8.3</span> Prelab Question</h3>
         <p>The switch of the relay can be used for countless
         applications. You can pass a signal or power through the
         switch. Decide on two simple projects that you can do for the
         “Choose your own project” section of this lab (see below).
         You’ll only need one in the end, but it will be good to have
         two options in case one doesn’t work out. You can use internet
         resources such as those listed under “Useful Readings” or look
         at the appendix.</p>
         <h2 data-number="3.9" id="lab-activities"><span
         class="header-section-number">3.9</span> Lab Activities</h2>
         <h3 data-number="3.9.1" id="8.1"><span
         class="header-section-number">3.9.1</span> Prelab Question</h3>
         <p>Read through all of the lab steps and identify the step (or
         sub-step) that you think will be the most challenging.</p>
         <h3 data-number="3.9.2" id="8.2"><span
         class="header-section-number">3.9.2</span> Prelab Question</h3>
         <p>List at least one question you have about the lab
         activity.</p>
         <h1 data-number="4" id="useful-readings"><span
         class="header-section-number">4</span> Useful Readings</h1>
         <ol type="1">
         <li><p>The internet has bountiful resources regarding Arduino
         programming and Arduino project ideas</p>
         <ul>
         <li><a href="https://www.arduino.cc/">Arduino Website</a>
         <ul>
         <li><a href="https://docs.arduino.cc/">The documentation
         page</a> is helpful.</li>
         <li><a href="https://www.arduino.cc/reference/en/">The Language
         Reference page</a> is particularly good to know about.</li>
         <li><a href="https://docs.arduino.cc/built-in-examples">Built
         in examples</a></li>
         </ul></li>
         <li>The multitude of internet resources on Arduino projects:
         <ul>
         <li><a href="https://docs.arduino.cc/tutorials/">Arduino
         tutorials.</a></li>
         <li><a href="https://projecthub.arduino.cc/">Official Arduino
         projects.</a></li>
         <li><a
         href="https://www.instructables.com/Arduino-Projects/">Instructables
         Arduino projects.</a></li>
         <li>Your search engine of choice (look out for stackexchange
         discussions: these are typically extremely helpful).</li>
         </ul></li>
         </ul></li>
         <li><p>Open Circuits has lots of nice relevant teardowns:</p>
         <ul>
         <li>76–83, 86–88 to see inside the ICs and the LED</li>
         <li>96 to see inside the optocoupler</li>
         <li>105–135 to see inside electromechanical objects (all of
         these are things that could be controlled by an Arduino
         project)</li>
         </ul></li>
         <li><p>On interfacing computers and microcontrollers with
         analog circuits:</p>
         <ul>
         <li><p>Horowitz and Hill 2<sup>nd</sup> ed. Chapters 11 and
         12</p></li>
         <li><p>Horowitz and Hill 3<sup>rd</sup> ed. Chapter 14</p></li>
         </ul></li>
         <li><p>On relays and optocouplers</p>
         <ul>
         <li><p>Horowitz and Hill 2<sup>nd</sup> ed. sections 1.32,
         9.10, 14.06</p></li>
         <li><p>Horowitz and Hill 3<sup>rd</sup> ed. sections 1.9.2,
         12.4.1, 12.7–12.7.8</p></li>
         </ul></li>
         <li><p>On BJT as switches</p>
         <ul>
         <li><p><a
         href="https://atomoptics-nas.uoregon.edu/~dsteck/teaching/electronics/electronics-notes.pdf">Steck</a>
         section 4.5</p></li>
         <li><p>Fischer-Cripps section 5.6</p></li>
         <li><p>Horowitz and Hill 2<sup>nd</sup> ed. section
         2.02</p></li>
         <li><p>Horowitz and Hill 3<sup>rd</sup> ed. section
         2.2.1</p></li>
         </ul></li>
         <li><p><a
         href="https://atomoptics-nas.uoregon.edu/~dsteck/teaching/electronics/electronics-notes.pdf">Steck</a>
         also has whole chapters on comparators (14), pulse-width
         waveform generation (15), and digital-analog interfaces
         (16).</p></li>
         </ol>
         <h1 data-number="5" id="lab-activities-1"><span
         class="header-section-number">5</span> Lab Activities</h1>
         <h2 data-number="5.1" id="blink"><span
         class="header-section-number">5.1</span> Blink</h2>
         <ol type="1">
         <li><p>Follow the instructions for <a
         href="https://docs.arduino.cc/built-in-examples/basics/Blink">the
         blink tutorial</a>. When you finish, you should see a yellow
         light on the Arduino board that blinks at 1 Hz.</p></li>
         <li><p>Open up the starter sketch that you downloaded (in the
         prelab) in the Arduino IDE.</p></li>
         <li><p>The Arduino Uno has 14 GPIO pins (digital pins that can
         be used for either input or output; though Pin 0 and Pin 1 are
         reserved for specific purposes). Determine which pin the sketch
         expects an LED to be connected to.</p></li>
         <li><p>Configure a single LED (HLMP-C625) and resistor on the
         breadboard such that they are in series and one end is
         connected to ground. The resistor is added to limit the current
         in the LED to 20 mA. You should have calculated the resistor
         value in the prelab.</p></li>
         <li><p>Connect the Arduino digital pin found above and the
         ground pin to the breadboard such that you have a complete
         circuit with the LED and resistor (see the diagram in the Blink
         tutorial).</p></li>
         <li><p>Run the starter sketch. What happens? Does this meet
         your expectations?</p></li>
         <li><p>Modify the sketch to make the LED flash at a frequency
         of 4 Hz with a 50% duty cycle. (Hint: Check out the
         <code>delay()</code> command and/or look at the Blink sketch
         you used above.) Document your changes in your lab
         notebook.</p></li>
         <li><p>Modify the sketch to make the LED flash at the same
         frequency but with a duty cycle where it will be on for 3/4 of
         the time and off for 1/4 of the time.</p></li>
         </ol>
         <h2 data-number="5.2"
         id="potentiometer-as-a-control-dial"><span
         class="header-section-number">5.2</span> Potentiometer as a
         Control Dial</h2>
         <ol type="1">
         <li><p>Connect your potentiometer so that you can control the
         voltage to one of the analog input pins (<em>Hint:</em> use the
         <span class="math inline">\(5\text{ V}\)</span> power pin on
         the Arduino as well as the ground pin. <span
         style="color: red;">DO NOT USE THE POWER SUPPLY</span>). Be
         sure to include your circuit diagram in your notebook.</p></li>
         <li><p>Add code to the sketch to read the value on the input
         pin and store it as an integer (<em>Hint:</em> check out the
         <code>analogRead()</code> command).</p></li>
         </ol>
         <p>In order to see the value on your computer, you will need to
         send the integer value over the serial bus (USB). If you’re
         experienced with C++ programming, you will be used to printing
         with something like
         <code>std::cout &lt;&lt; "Hello World" &lt;&lt; \n;</code>
         however, there is nowhere for the microcontroller to directly
         print to. Instead, you will use
         <code>Serial.println("Hello World);</code> to send the string
         to the computer your Arduino is connected to. The Arduino IDE
         has a serial monitor button (the magnifying glass in the to
         right corner) that you have to press to see the messages sent
         over the USB by the Arduino.</p>
         <ol start="3" type="1">
         <li><p>Output the stored value of the voltage drop across the
         potentiometer to the computer over the Serial connection
         (<em>Hint:</em> Check out the <code>Serial.begin()</code> and
         <code>Serial.println()</code> commands). 9600 bits per second
         is a standard rate for serial communication.</p></li>
         <li><p>Load the sketch and determine whether the readings
         correctly correspond with the voltage of the voltage divider
         (you can use the DMM to help confirm).</p></li>
         <li><p>Modify the sketch to make the frequency of the flashing
         LED change based on the setting of the potentiometer. Use a
         frequency range that covers the range in which you would
         describe the LED as “flashing” (that is, not too fast and not
         too slow). Document your changes in your lab book.</p></li>
         </ol>
         <p>This just gives a taste of having a <em>user input</em> to
         control something. Potemiometers are one of the most common
         ways to take a <em>user input</em>, but there are many other
         tools such as optical encoders, buttons, switches,
         variable-capacitors, microphones, photodiodes, etc. can all be
         used in ways to allow a user to interact with the system.</p>
         <h2 data-number="5.3" id="led-bank"><span
         class="header-section-number">5.3</span> 10-LED bank</h2>
         <p>Now use the Arduino to control the 10-LED bank (MV57164)</p>
         <ul>
         <li><p>Use 10 separate GPIO pins to control each LED in the
         bank.</p></li>
         <li><p>For each LED in the 10-LED bank, use a unique resistor
         (so that would be 10 resistors in total).</p></li>
         <li><p>Calculate the current when all 10 are on and the current
         when just 1 LED is on.</p></li>
         <li><p>Don’t use pins 0 and 1, as these are reserved for direct
         communication with the microcontroller chip.</p></li>
         </ul>
         <p><em>Hint:</em> use a breadboard column to connect all the
         cathodes of the LEDs together and then use your resistor
         connect between this column and ground.</p>
         <ol type="1">
         <li>Modify your code to make all the LEDs flash together.
         (Hint: Instead of controlling each one with its own line of
         code, use <code>for</code> loops to do the same thing to all of
         them in turn. You’ll need to set the <code>pinMode</code> of
         each output to <code>OUTPUT</code> in the setup routine.
         Document your changes in your lab notebook.)</li>
         </ol>
         <p>Here’s a quick reminder of C++ for loop syntax</p>
         <div class="sourceCode" id="cb3"><pre
         class="sourceCode c++"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> ii <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> ii <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> ii<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>   Serial<span class="op">.</span>println<span class="op">(</span>ii<span class="op">)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
         <p>will print this to the serial monitor:</p>
         <pre><code>0
1
2
3
4</code></pre>
         <ol start="2" type="1">
         <li><p>Now, further modify your code to make each LED flash in
         sequence. Document your changes in your lab notebook.</p></li>
         <li><p>Now, further modify your code to make each LED flash in
         sequence. Document your changes in your lab notebook.</p></li>
         <li><p>Include the final version of your sketch in your lab
         notebook.</p></li>
         </ol>
         <p><em>Hint:</em> in a Markdown cell in a Jupyter notebook you
         can use</p>
         <pre><code>```c++
\\ code
```                                    . </code></pre>
         <h2 data-number="5.4" id="opto-isolated-relay-control"><span
         class="header-section-number">5.4</span> Opto-isolated Relay
         Control</h2>
         <p>Now you will build the circuit in Figure <a
         href="#fig:opto-isolated-relay">6</a> with the values of
         resistors you calculated in the prelab (you may want to
         corroborate with your peers or check with an instructor to
         confirm your calculations make sense).</p>
         <ul>
         <li><p>The datasheet for the optocoupler (SFH615) has incorrect
         information on the orientation of the DIP chip. Figure <a
         href="#fig:opto-dip">7</a> shows the correct orientation with a
         notch cut out of the left side of the DIP chip.</p></li>
         <li><p>Determine how you will test that the relay
         switches?</p></li>
         <li><p><span style="color: red;"><strong>IN ORDER TO KEEP THE
         ARDUINO ISOLATED, THE ARDUINO COMMON GROUND MUST <em>NOT</em>
         BE CONNECTED TO THE CIRCUIT’S GROUND</strong></span></p></li>
         <li><p>Build and test the circuit.</p></li>
         </ul>
         <div id="fig:opto-dip" class="fignos">
         <figure>
         <img src="../resources/lab10fig/optocoupler-dip.png"
         style="width:10cm"
         alt="Figure 7: The optocoupler has a knotch taken out of the left side of the DIP chip. The left pins (1 and 2) are to the LED and the right pins (3 and 4) are to the phototransistor." />
         <figcaption aria-hidden="true"><span>Figure 7:</span> The
         optocoupler has a knotch taken out of the left side of the DIP
         chip. The left pins (1 and 2) are to the LED and the right pins
         (3 and 4) are to the phototransistor.</figcaption>
         </figure>
         </div>
         <h2 data-number="5.5"
         id="explore---choose-your-own-project"><span
         class="header-section-number">5.5</span> Explore - Choose Your
         Own Project</h2>
         <p>Now that you have a taste of what Arduinos can do, pick a
         simple project and do it! It can be an extension of the
         flashing LEDs you just made, or something completely different.
         Feel free to use any of the components we’ve used in previous
         labs. Document your goals, approach, progress, and results in
         your lab notebook. Remember that the lab notebook should be a
         complete record which someone else could use without difficulty
         to reproduce what you did. If you are having trouble deciding
         on a project, there are some suggestions in the appendix.</p>
         <h1 data-number="6" id="appendix-a-few-project-ideas"><span
         class="header-section-number">6</span> Appendix: A Few Project
         Ideas</h1>
         <ul>
         <li><p>Adjust your current 10-LED setup so that it counts up in
         binary.</p></li>
         <li><p>Use the potentiometer to control the brightness of the
         LEDs using the concept of Pulse Width Modulation (PWM). As long
         as the LED is flashing faster than about 60 Hz, it will simply
         appear solid. You can flash with a varying duty cycle to make
         it brighter or dimmer. You can do this yourself or with the
         “analogWrite” function. You could replace the potentiometer
         with the input from the 3.5mm headphone jack plugged into a
         device that is playing music so that the LED brightness depends
         on the volume of the music.</p></li>
         <li><p>Connect your speaker to one of the digital outputs. Use
         the “tone” function to play frequencies. You can control the
         frequencies with the potentiometer. Or, you can use the
         photometer circuit from Lab 6 to provide the voltage so that
         the sound frequency is dependent on the light level. Or you can
         use the “random” function to play random frequencies.</p></li>
         <li><p>Generate a periodic square wave with the 555 Timer
         circuit from the last lab but configure it to use a
         potentiometer and a resistor to allow for a range of
         frequencies. You should power the 555 Timer with the +5 V from
         the Arduino. Feed the output of the 555 Timer circuit into the
         Arduino and measure the length of time that the pulse is high
         and low (see the “pulseIn” function). From that, calculate the
         period, frequency, and duty cycle. Print out the information
         and see what happens when you vary the potentiometer.</p></li>
         </ul>
               </div>
            <!-- Mathjax -->
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script>

      </script>
   </body>
</html>
